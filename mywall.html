<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tagshop Wall ‚Äì Tagshop</title>
<link rel="stylesheet" href="uniform-dark-glass.css">
<style>
body { background:#000; color:#fff; font-family:system-ui; padding:20px; }
h1{text-align:center;margin-bottom:10px;}
#affiliateIdDisplay { text-align:center; font-weight:bold; color:#ff9900; text-shadow: 0 0 8px #ff9900; margin-bottom:10px; font-size:16px; }
.grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(100px,1fr)); gap:8px; }
.card { background: rgba(0,0,0,0.35); border:1px solid rgba(255,255,255,0.12); border-radius:12px; padding:6px; text-align:center; }
.card img { max-width:100%; border-radius:6px; cursor:pointer; transition:0.3s; }
.card img:hover { transform: scale(1.05); }
button { margin-top:4px; background:#00FFFF; border:none; border-radius:6px; cursor:pointer; color:#000; font-weight:700; padding:4px 8px; font-size:12px; }

/* Affiliate Pop-Up */
#affiliatePopup {
  position:fixed; bottom:20px; right:20px; width:300px; max-width:90%;
  background: rgba(0,0,0,0.95); backdrop-filter: blur(12px);
  border:1px solid #ffa500; border-radius:16px; padding:16px; z-index:999;
  color:#fff; display:none; box-shadow:0 4px 20px rgba(0,0,0,0.6);
}
#affiliatePopup h2 { color:#ffa500; font-size:16px; margin:0 0 10px 0; text-align:center; }
#affiliatePopup input, #affiliatePopup button { margin:4px 0; font-size:12px; width:100%; padding:6px; border-radius:8px; }

/* Affiliate Toggle Button */
#affiliateToggle { 
  position:fixed; bottom:20px; right:340px; background:#000; color:#ffa500; border:none; border-radius:16px; padding:10px 14px; font-weight:700; cursor:pointer; z-index:1000; 
}

/* Page Socials at bottom */
.page-socials { position:fixed; bottom:20px; left:20px; display:flex; gap:6px; z-index:1000; }
.social-btn { width:30px; height:30px; background:#000; color:#fff; border:none; border-radius:50%; font-weight:bold; cursor:pointer; font-size:14px; line-height:28px; text-align:center; }
.social-btn:hover { opacity:0.8; }

/* Visitor count display */
#visitorCount { position:fixed; top:20px; right:20px; color:#0ff; font-weight:bold; font-size:14px; }

/* Floating Home Button */
#homeBtn {
  position:fixed;
  bottom:20px;
  right:120px;
  background:#000;
  color:#ffe169;
  border:none;
  border-radius:16px;
  padding:10px 14px;
  font-weight:700;
  cursor:pointer;
  z-index:1000;
  box-shadow: 0 0 8px rgba(255, 225, 105, 0.7);
}
</style>
</head>
<body>

<h1 id="wallTitle">Tagshop</h1>
<div id="affiliateIdDisplay"></div>
<div id="visitorCount">Visitors: 0</div>
<div class="grid" id="wallGrid"></div>

<!-- Affiliate Toggle Button -->
<button id="affiliateToggle">Affiliate</button>

<!-- Affiliate Pop-Up -->
<div id="affiliatePopup">
  <h2>üîë Affiliate Activation</h2>
  <input type="text" id="amazonAffiliate" placeholder="Amazon tag (e.g., mytag-20)">
  <input type="text" id="temuAffiliate" placeholder="Temu tag">
  <input type="text" id="lazadaAffiliate" placeholder="Lazada tag">
  <input type="text" id="aliexpressAffiliate" placeholder="AliExpress tag">
  <button id="saveAffiliate">Activate</button>
  <div id="affiliateOutput" style="margin-top:6px;font-size:12px;color:#ffa500;"></div>
</div>

<!-- Page Social Media Buttons -->
<div class="page-socials">
  <button class="social-btn" onclick="window.open('https://facebook.com/@linkbotlabs','_blank')" title="F @linkbotlabs">F</button>
  <button class="social-btn" onclick="window.open('https://x.com/@linkbotlabs','_blank')" title="X @linkbotlabs">X</button>
  <button class="social-btn" onclick="window.open('https://tiktok.com/@linkbotlabs','_blank')" title="Tik @linkbotlabs">T</button>
  <button class="social-btn" onclick="window.open('https://youtube.com/@linkbotlabs','_blank')" title="YT @linkbotlabs">Y</button>
</div>

<!-- Floating Home Button -->
<button id="homeBtn" onclick="window.location.href='index.html'">üè† Home</button>

<script>
// ===== Visitor Count =====
let visitors = parseInt(localStorage.getItem("visitorCount")||"0") + 1;
localStorage.setItem("visitorCount", visitors);
document.getElementById("visitorCount").innerText = "Visitors: " + visitors;

// ===== Affiliate Handling =====
const popup = document.getElementById("affiliatePopup");
const toggleBtn = document.getElementById("affiliateToggle");
toggleBtn.addEventListener("click",()=>{ 
  popup.style.display = (popup.style.display==="block")?"none":"block"; 
});

// Save Affiliate Tags
document.getElementById("saveAffiliate").addEventListener("click",()=>{
  const amazon = document.getElementById("amazonAffiliate").value.trim();
  const temu = document.getElementById("temuAffiliate").value.trim();
  const lazada = document.getElementById("lazadaAffiliate").value.trim();
  const aliexpress = document.getElementById("aliexpressAffiliate").value.trim();
  const tags = { amazon, temu, lazada, aliexpress };
  localStorage.setItem('userAffiliateTags', JSON.stringify(tags));
  document.getElementById("affiliateOutput").innerText = `‚úÖ Tags saved!\nAmazon: ${amazon}\nTemu: ${temu}\nLazada: ${lazada}\nAliExpress: ${aliexpress}`;

  // Display first non-empty affiliate ID at top
  const firstId = amazon || temu || lazada || aliexpress;
  document.getElementById("affiliateIdDisplay").innerText = "Affiliate ID: " + firstId;
});

// ===== Product Wall =====
const wallGrid = document.getElementById("wallGrid");
function renderWall(){
  const wall = JSON.parse(localStorage.getItem("productWall")||"[]");
  wallGrid.innerHTML = "";
  wall.forEach((item,idx)=>{
    const div = document.createElement("div");
    div.className="card";
    div.innerHTML = `
      ${item.thumb?`<img src="${item.thumb}" onclick="expandItem(${idx})">`:""}
      <div style="font-size:12px;margin-top:4px;"><strong>${item.title}</strong></div>
      <a href="${buildAffiliateLink(item.link)}" target="_blank" style="color:#ffa500;font-size:12px;text-decoration:none;">Click to Buy</a><br>
      <button onclick="addToWall(${idx})">Add to Wall</button>
      <button onclick="removeItem(${idx})">Remove</button>
    `;
    wallGrid.appendChild(div);
  });
}
function removeItem(idx){
  const wall = JSON.parse(localStorage.getItem("productWall")||"[]");
  wall.splice(idx,1);
  localStorage.setItem("productWall", JSON.stringify(wall));
  renderWall();
}
function expandItem(idx){
  const wall = JSON.parse(localStorage.getItem("productWall")||"[]");
  const item = wall[idx];
  alert(`Title: ${item.title}\nLink: ${item.link}`);
}

function addToWall(idx){
  let wall = JSON.parse(localStorage.getItem("productWall")||"[]");
  
  // Check 10-item limit
  if(wall.length >= 10 && !localStorage.getItem("wallUnlocked")){
    // Show Wise payment overlay
    const popupDiv = document.createElement("div");
    popupDiv.style.position="fixed";
    popupDiv.style.top="50%";
    popupDiv.style.left="50%";
    popupDiv.style.transform="translate(-50%,-50%)";
    popupDiv.style.background="rgba(0,0,0,0.95)";
    popupDiv.style.color="#fff";
    popupDiv.style.padding="20px";
    popupDiv.style.border="2px solid #00FFFF";
    popupDiv.style.borderRadius="12px";
    popupDiv.style.zIndex=9999;
    popupDiv.innerHTML = `
      ‚ö†Ô∏è You have added 10 items!<br>
      To continue, please support the developer:<br>
      <a href="https://wise.com/pay/me/davids14542" target="_blank" style="color:#00FFFF; font-weight:bold;">Pay via Wise</a><br><br>
      <input type="password" id="unlockPassword" placeholder="Enter password to continue" style="width:100%;padding:6px;border-radius:6px;margin-top:6px;">
      <button id="unlockBtn" style="margin-top:6px;padding:6px 12px;border-radius:6px;background:#00FFFF;color:#000;cursor:pointer;">Unlock</button>
    `;
    document.body.appendChild(popupDiv);

    document.getElementById("unlockBtn").onclick = ()=>{
      const val = document.getElementById("unlockPassword").value;
      if(val === "tagshopme"){
        localStorage.setItem("wallUnlocked","true");
        alert("Wall unlocked! You can continue adding items.");
        popupDiv.remove();
      } else {
        alert("Incorrect password.");
      }
    }
    return;
  }

  renderWall();
}

renderWall();

// ===== Build Affiliate Link =====
function buildAffiliateLink(originalLink){
  const tags = JSON.parse(localStorage.getItem('userAffiliateTags')||"{}");
  if(originalLink.includes("amazon.com")) return tags.amazon?originalLink+(originalLink.includes("?")?"&":"?")+"tag="+tags.amazon:originalLink;
  if(originalLink.includes("temu.com")) return tags.temu?originalLink+(originalLink.includes("?")?"&":"?")+"aff_id="+tags.temu:originalLink;
  if(originalLink.includes("lazada.co.th")) return tags.lazada?originalLink+(originalLink.includes("?")?"&":"?")+"spm="+tags.lazada:originalLink;
  if(originalLink.includes("aliexpress.com")) return tags.aliexpress?originalLink+(originalLink.includes("?")?"&":"?")+"aff_fcid="+tags.aliexpress:originalLink;
  return originalLink;
}
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
<script>
(function(){
  const AGREE_KEY = "tagshopUserAgreed";
  const SECRET_PASSWORD = "tagshopme"; // change if desired
  let actionCount = 0, MAX_ACTIONS = 3;

  document.body.addEventListener("click", e=>{
    if(e.target.tagName==="BUTTON"||e.target.closest("button")){
      actionCount++;
      if(actionCount>=MAX_ACTIONS && !localStorage.getItem(AGREE_KEY)) showPopup();
    }
  });

  function showPopup(){
    const overlay=document.createElement("div");
    overlay.style=`
      position:fixed;inset:0;background:rgba(0,0,0,0.9);z-index:9999;
      display:flex;justify-content:center;align-items:center;padding:20px;color:#fff;
    `;
    const box=document.createElement("div");
    box.style=`
      background:rgba(20,20,20,0.9);border:2px solid #ffe169;border-radius:16px;
      max-width:420px;width:90%;padding:20px;text-align:center;font-family:system-ui;
      box-shadow:0 0 15px rgba(255,255,255,0.3);
    `;
    overlay.appendChild(box);
    document.body.appendChild(overlay);

    box.innerHTML=`
      <h2 style="color:#ffe169;margin-bottom:8px;">Welcome to Tagshop üåü</h2>
      <p style="font-size:14px;margin-bottom:10px;">
        Build affiliate walls and earn commission from every sale.
      </p>
      <div style="font-size:13px;text-align:left;margin-bottom:12px;line-height:1.4;">
        <strong>How it works</strong><br>
        ‚Ä¢ Add up to 10 products to your wall.<br>
        ‚Ä¢ Share your affiliate wall link.<br>
        ‚Ä¢ Earn when your visitors buy.<br><br>
        <strong>Benefits</strong><br>
        ‚Ä¢ Amazon / Temu / Lazada support.<br>
        ‚Ä¢ Private, shareable wall.<br>
        ‚Ä¢ Optional donation keeps Tagshop ad-free.
      </div>
      <button id="agreeBtn" style="
        background:#ffe169;color:#000;border:none;border-radius:8px;
        font-weight:700;padding:10px 18px;cursor:pointer;">Agree & Continue</button>
    `;

    // Attach AFTER element creation
    box.querySelector("#agreeBtn").addEventListener("click", ()=>showDonation(box,overlay));
  }

  function showDonation(box,overlay){
    box.innerHTML=`
      <h2 style="color:#1fc27e;margin-bottom:10px;">Support Tagshop üíö</h2>
      <p style="font-size:14px;margin-bottom:10px;">Optional donation helps maintain free AI tools.</p>
      <div style="display:flex;justify-content:center;gap:8px;margin-bottom:14px;flex-wrap:wrap;">
        <button data-amt="usd" style="background:#000;color:#ffe169;border-radius:6px;padding:6px 10px;">$5 USD</button>
        <button data-amt="gbp" style="background:#000;color:#ffe169;border-radius:6px;padding:6px 10px;">¬£8 GBP</button>
        <button data-amt="thb" style="background:#000;color:#ffe169;border-radius:6px;padding:6px 10px;">‡∏ø200 THB</button>
      </div>
      <div id="qrHolder" style="margin:10px auto;"></div>
      <p style="font-size:12px;margin-top:6px;">or unlock with password:</p>
      <input type="password" id="unlockPass" placeholder="Enter password" style="
        width:80%;padding:6px;border-radius:6px;border:1px solid #444;background:#111;color:#fff;"><br>
      <button id="unlockBtn" style="background:#1fc27e;color:#000;border:none;border-radius:6px;padding:6px 10px;margin-top:8px;">Unlock</button>
      <div id="msg" style="margin-top:10px;font-size:13px;color:#1fc27e;"></div>
    `;

    const qrCanvas=document.createElement("canvas");
    document.getElementById("qrHolder").appendChild(qrCanvas);
    const qr=new QRious({
      element:qrCanvas,
      size:180,
      value:"https://wise.com/pay/me/davids14542/5usd"
    });

    // currency buttons
    box.querySelectorAll("[data-amt]").forEach(btn=>{
      btn.addEventListener("click",()=>{
        const v=btn.dataset.amt;
        const urls={
          usd:"https://wise.com/pay/me/davids14542/5usd",
          gbp:"https://wise.com/pay/me/davids14542/8gbp",
          thb:"https://wise.com/pay/me/davids14542/200thb"
        };
        qr.set({value:urls[v]});
        box.querySelector("#msg").innerText=`QR updated for ${btn.innerText}`;
      });
    });

    // password unlock
    box.querySelector("#unlockBtn").addEventListener("click",()=>{
      const val=box.querySelector("#unlockPass").value.trim();
      if(val===SECRET_PASSWORD){
        localStorage.setItem(AGREE_KEY,"true");
        overlay.remove();
        box.remove();
        // subtle inline success
        const note=document.createElement("div");
        note.textContent="‚úÖ Tagshop unlocked. Thank you!";
        note.style="position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#1fc27e;color:#000;padding:8px 14px;border-radius:8px;font-weight:700;";
        document.body.appendChild(note);
        setTimeout(()=>note.remove(),3000);
      }else{
        box.querySelector("#msg").innerText="Incorrect password.";
      }
    });
  }
})();
</script>
